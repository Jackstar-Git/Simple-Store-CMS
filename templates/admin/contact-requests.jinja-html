<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="{{ url_for('internal.uploads', filename='Logo.png') }}" type="image">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin/contact-requests.css') }}">
    <title>Admin Panel - Kontaktanfragen</title>
</head>
<body>
    <div class="main-container">
        {% include "admin/sidebar.jinja-html" %}

        <div class="main-content">
            <h2>Übersicht Kontaktanfragen</h2>
            <div class="product-filters">
                <div class="filter-menu">
                    <select id="status-filter" onchange="filterRequests()">
                        <option value="all">Alle Status</option>
                        <option value="offen">Offen</option>
                        <option value="in bearbeitung">In Bearbeitung</option>
                        <option value="geschlossen">Geschlossen</option>
                    </select>
                </div>
                <div class="sort-options">
                    <select id="sort-options" onchange="sortRequests()">
                        <option value="default">Sortieren nach</option>
                        <option value="date-asc">Datum: Alt zu Neu</option>
                        <option value="date-desc">Datum: Neu zu Alt</option>
                        <option value="name-asc">Name: A-Z</option>
                        <option value="name-desc">Name: Z-A</option>
                    </select>
                </div>
            </div>
            <div class="requests-list">
                {% for request in requests %}
                    <div class="request-item" data-status="{{ request.status }}" data-date="{{ request.date }}" data-name="{{ request.name }}">
                        <div class="request-info">
                            <h3>{{ request.subject }}</h3>
                            <p>{{ request.name }}</p>
                            <p>{{ request.email }}</p>
                        </div>
                        <div class="request-message">
                            <p>{{ request.message[:120] }}{% if request.message|length > 120 %}...{% endif %}</p>
                        </div>
                        <div class="request-date">
                            <p>{{ request.date }}</p>
                        </div>
                        <div class="request-status">
                            {% if request.status == 'offen' %}
                                <i class="fas fa-times-circle" style="color: red;"></i>
                            {% elif request.status == 'in bearbeitung' %}
                                <i class="fas fa-clock" style="color: darkorange;"></i>
                            {% else %}
                                <i class="fas fa-check-circle" style="color: green;"></i>
                            {% endif %}
                        </div>
                        <div class="request-actions">
                            <a href="/admin/kontakt/{{ request.id }}" class="btn view-btn"><i class="fas fa-eye"></i></a>
                            <a href="/api/delete-contact-request?id={{ request.id }}" class="btn delete-btn" onclick="return confirm('Bist du sicher, dass du diese Kontaktanfrage löschen möchtest?')"><i class="fas fa-trash-alt"></i></a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/admin/contact-requests.js') }}"></script>
</body>
</html>
